Most of this code comes from [alfred-pp][alfred-pp].

[alfred-pp]: https://github.com/bfontaine/alfred-pp
